{"version":3,"file":"popover.controller.0eb98720.js","sources":["../../../node_modules/@spryker-oryx/ui/utilities/browser.js","../../../node_modules/@spryker-oryx/ui/overlays/popover/src/controllers/dimension.controller.js","../../../node_modules/@spryker-oryx/ui/overlays/popover/src/controllers/highlight.controller.js","../../../node_modules/@spryker-oryx/ui/overlays/popover/src/controllers/selected.controller.js","../../../node_modules/@spryker-oryx/ui/overlays/popover/src/controllers/toggle.controller.js","../../../node_modules/@spryker-oryx/ui/overlays/popover/src/popover.controller.js"],"sourcesContent":["export const isSafari = () => /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\nexport const nonFocusableOnClickInSafari = [\n    'button',\n    'input[type=\"radio\"]',\n    'input[type=\"checkbox\"]',\n    'input[type=\"submit\"]',\n];\n//# sourceMappingURL=browser.js.map","import { POPOVER_HEIGHT } from '../popover.model';\nexport class DimensionController {\n    constructor(host) {\n        this.host = host;\n        this.host.addController(this);\n    }\n    setBoundingBox(element) {\n        const vOffset = this.getComputedProperty(this.host, '--oryx-popover-vertical-offset') ??\n            0;\n        const maxHeight = this.getComputedProperty(this.host, '--oryx-popover-maxheight') ??\n            POPOVER_HEIGHT;\n        const maxWidth = this.getComputedProperty(this.host, '--oryx-popover-maxwidth') ?? 0;\n        const { top, right, bottom, left, boundingElementWidth, boundingElementHeight, } = this.getAvailableSpace(element);\n        const isRTL = getComputedStyle(document.documentElement).direction === 'rtl';\n        this.host.toggleAttribute('rtl', isRTL);\n        const toRight = left < maxWidth && right > left;\n        const toLeft = right < maxWidth && left > right;\n        this.host.toggleAttribute('up', bottom < maxHeight && top > bottom);\n        this.host.toggleAttribute('end', (!isRTL && toRight) || (isRTL && toLeft));\n        this.host.toggleAttribute('start', (!isRTL && toLeft) || (isRTL && toRight));\n        const properties = {\n            '--_available-popover-height': `${Math.max(bottom, top) - Number(vOffset)}px`,\n            '--_available-popover-width-start': `${isRTL ? right : left}px`,\n            '--_available-popover-width-end': `${isRTL ? left : right}px`,\n            '--_bounding-element-width': `${boundingElementWidth}px`,\n            '--_bounding-element-height': `${boundingElementHeight}px`,\n        };\n        this.setStyleProperties(properties);\n    }\n    setStyleProperties(properties) {\n        for (const propName in properties) {\n            this.host.style.setProperty(propName, properties[propName]);\n        }\n    }\n    getAvailableSpace(element) {\n        const { top, left, bottom, right, width, height } = element.getBoundingClientRect();\n        return {\n            top,\n            left,\n            bottom: window.innerHeight - bottom,\n            right: window.innerWidth - right,\n            boundingElementWidth: width,\n            boundingElementHeight: height,\n        };\n    }\n    getComputedProperty(element, propName) {\n        const property = window\n            ?.getComputedStyle(element)\n            .getPropertyValue(propName);\n        if (!property) {\n            return;\n        }\n        return parseFloat(property);\n    }\n}\n//# sourceMappingURL=dimension.controller.js.map","import { CLOSE_EVENT } from '../popover.model';\nconst OUT_OF_INDEX = -1;\n/**\n * Toggles the highlight attribute on a list of items for keyboard users.\n * The arrow down/up, page down/up, home/end the highlight moves the highlight\n * up or down.\n *\n * - arrow up/down: move one up/down. Moves to top/bottom when end of list is reached.\n * - arrow up/down + meta key: move 10 up/down\n * - page up/down: move 10 up/down\n * - home: move to top\n * - end: move to bottom\n *\n * The `highlight` attribute is applied to the item and can further be used in CSS.\n *\n * ```html\n * <item>first</item>\n * <item highlight>second</item>\n * <item>third</item>\n * ```\n *\n * The items are configurable by the `listItemsSelector`.\n */\nexport class HighlightController {\n    constructor(host, listItemsSelector) {\n        this.host = host;\n        this.listItemsSelector = listItemsSelector;\n        this.host.addController(this);\n        this.handleKeydown = this.handleKeydown.bind(this);\n        this.clear = this.clear.bind(this);\n    }\n    hostConnected() {\n        this.host.addEventListener('keydown', this.handleKeydown);\n        this.host.addEventListener(CLOSE_EVENT, this.clear);\n    }\n    hostDisconnected() {\n        this.host.removeEventListener('keydown', this.handleKeydown);\n        this.host.removeEventListener(CLOSE_EVENT, this.clear);\n    }\n    clear() {\n        this.highlight = OUT_OF_INDEX;\n    }\n    get highlight() {\n        return this.items.findIndex((item) => item.hasAttribute('highlight'));\n    }\n    set highlight(index) {\n        this.items[this.highlight]?.toggleAttribute('highlight', false);\n        const option = this.items[index];\n        if (option) {\n            option.toggleAttribute('highlight', true);\n            // unfortunately no native smooth scrolling for block scrolling\n            option.scrollIntoView({ block: 'nearest' });\n            // ensures that the element becomes visible after animation time\n            setTimeout(() => {\n                option.scrollIntoView({ block: 'nearest' });\n            }, 300);\n        }\n    }\n    handleKeydown(e) {\n        switch (e.key) {\n            case 'ArrowUp':\n                if (e.metaKey) {\n                    this.move(e, -10, 0);\n                }\n                else {\n                    this.move(e, -1, this.items.length - 1);\n                }\n                break;\n            case 'ArrowDown':\n                if (e.metaKey) {\n                    this.move(e, 10, this.items.length - 1);\n                }\n                else {\n                    this.move(e, 1, 0);\n                }\n                break;\n            case 'PageUp':\n                this.move(e, -10, 0);\n                break;\n            case 'PageDown':\n                this.move(e, 10, this.items.length - 1);\n                break;\n            case 'Home':\n                this.move(e);\n                break;\n            case 'End':\n                this.move(e, undefined, this.items.length - 1);\n                break;\n        }\n    }\n    move(e, moveBy, fallback = 0) {\n        e.preventDefault();\n        if (this.highlight === OUT_OF_INDEX) {\n            this.highlight = this.selected;\n        }\n        let highlight = this.highlight;\n        if (moveBy) {\n            highlight = this.highlight + moveBy;\n        }\n        else {\n            highlight = fallback;\n        }\n        if (highlight < 0 || highlight >= this.items.length) {\n            highlight = fallback;\n        }\n        this.highlight = highlight;\n    }\n    get selected() {\n        return this.items.findIndex((item) => item.hasAttribute('selected'));\n    }\n    get items() {\n        return Array.from(this.host.querySelectorAll(this.listItemsSelector));\n    }\n}\n//# sourceMappingURL=highlight.controller.js.map","/**\n * Toggles the `selected` attribute on a list of item. The `highlight` attribute\n * is applied to the item and can further be used in CSS.\n *\n * ```html\n * <item>first</item>\n * <item selected>second</item>\n * <item>third</item>\n * ```\n *\n * The items are configurable by the `listItemsSelector`.\n */\nexport class SelectedController {\n    constructor(host, listItemsSelector) {\n        this.host = host;\n        this.listItemsSelector = listItemsSelector;\n        this.host.addController(this);\n        this.handleMouseup = this.handleMouseup.bind(this);\n    }\n    hostConnected() {\n        this.host.addEventListener('mouseup', this.handleMouseup);\n    }\n    hostDisconnected() {\n        this.host.removeEventListener('mouseup', this.handleMouseup);\n    }\n    deselect() {\n        this.select(-1);\n    }\n    select(index, omitDispatchEvent) {\n        if (this.selected === index) {\n            return;\n        }\n        this.items\n            .find((item) => item.hasAttribute('selected'))\n            ?.removeAttribute('selected');\n        const selected = this.items[index];\n        if (selected) {\n            this.selected = index;\n            if (!omitDispatchEvent) {\n                const event = new CustomEvent('oryx.select', {\n                    detail: { selected },\n                    bubbles: true,\n                    composed: true,\n                });\n                this.host.dispatchEvent(event);\n            }\n        }\n    }\n    handleMouseup(e) {\n        const index = this.items.indexOf(e.target);\n        if (index > -1) {\n            this.select(index);\n        }\n    }\n    get selected() {\n        return this.items.findIndex((item) => item.hasAttribute('selected'));\n    }\n    set selected(index) {\n        this.items[index].toggleAttribute('selected', true);\n    }\n    get items() {\n        return Array.from(this.host.querySelectorAll(this.listItemsSelector));\n    }\n}\n//# sourceMappingURL=selected.controller.js.map","import { isSafari, nonFocusableOnClickInSafari, } from '@spryker-oryx/ui/utilities';\nimport { isFocusable } from '@spryker-oryx/utilities/typescript';\nimport { getControl } from '../../../../form/utilities';\nimport { CLOSE_EVENT, CLOSE_POPOVER_ATTR, } from '../popover.model';\nimport { DimensionController } from './dimension.controller';\nfunction timePassed(start, timeGap = 300) {\n    return Date.now() - start > timeGap;\n}\n/**\n * Toggles an element when the user uses the keyboard, by toggling the \"show\" attribute.\n * Also toggles the \"open\" attribute on the host element.\n *\n * - Enter / space – toggles the `show` attribute\n * - Escape – removes the `show` attribute\n * - Any key – adds the `show` attribute\n *\n * When the meta key (cmd/ctrl) is used, the 'show' attribute is not toggled.\n *\n * The toggled element can be specified by the `elementSelector` option.\n */\nexport class ToggleController {\n    constructor(host, options) {\n        this.host = host;\n        this.options = options;\n        /**\n         * Indicates that focusout event was dispatched before focusin\n         */\n        this.timeStarted = 0;\n        /**\n         * Indicates that key on keyboard is pressed\n         */\n        this.keyIsPressed = false;\n        /**\n         * Until Safari has issue with focusing of some elements during click on them\n         * need to remember those elements and make them focused manually\n         */\n        this.shouldBeFocused = null;\n        this.host.addController(this);\n        this.dimensionController = new DimensionController(host);\n        this.handleBlur = this.handleBlur.bind(this);\n        this.handleFocusin = this.handleFocusin.bind(this);\n        this.handleFocusout = this.handleFocusout.bind(this);\n        this.handleMousedown = this.handleMousedown.bind(this);\n        this.handleMouseup = this.handleMouseup.bind(this);\n        this.handleKeydown = this.handleKeydown.bind(this);\n        this.handleKeyup = this.handleKeyup.bind(this);\n        this.handleContentCloseEvent = this.handleContentCloseEvent.bind(this);\n    }\n    async hostConnected() {\n        window.addEventListener('blur', this.handleBlur);\n        this.host.addEventListener(CLOSE_EVENT, this.handleContentCloseEvent);\n        this.host.addEventListener('focusin', this.handleFocusin);\n        this.host.addEventListener('focusout', this.handleFocusout);\n        this.host.addEventListener('mousedown', this.handleMousedown);\n        this.host.addEventListener('mouseup', this.handleMouseup);\n        this.host.addEventListener('keydown', this.handleKeydown);\n        this.host.addEventListener('keyup', this.handleKeyup);\n        if (this.host.hasAttribute('open')) {\n            //simulate first updated hook\n            this.host.requestUpdate();\n            await this.host.updateComplete;\n            this.setBoundingBox();\n        }\n    }\n    hostDisconnected() {\n        window.removeEventListener('blur', this.handleBlur);\n        this.host.removeEventListener(CLOSE_EVENT, this.handleContentCloseEvent);\n        this.host.removeEventListener('focusin', this.handleFocusin);\n        this.host.removeEventListener('focusout', this.handleFocusout);\n        this.host.removeEventListener('mousedown', this.handleMousedown);\n        this.host.removeEventListener('mouseup', this.handleMouseup);\n        this.host.removeEventListener('keydown', this.handleKeydown);\n        this.host.removeEventListener('keyup', this.handleKeyup);\n    }\n    handleBlur() {\n        this.skipOpeningOnNextFocus = true;\n        if (this.isOpen) {\n            this.toggle(false);\n        }\n    }\n    handleFocusin() {\n        if (!this.skipOpeningOnNextFocus && this.options.showOnFocus) {\n            this.timeStarted = Date.now();\n            this.toggle(true);\n        }\n        this.skipOpeningOnNextFocus = false;\n    }\n    async handleFocusout() {\n        if (!this.host.matches(':focus-within')) {\n            this.toggle(false);\n        }\n        this.focusShouldBeFocusedMaybe();\n    }\n    handleMousedown(e) {\n        if (!isFocusable(e.target) &&\n            this.emitterIsInsidePopover(e)) {\n            e.preventDefault();\n            e.stopPropagation();\n            return;\n        }\n        if (isSafari()) {\n            this.shouldBeFocused =\n                e.composedPath().find((element) => {\n                    return nonFocusableOnClickInSafari.some((selector) => element instanceof HTMLElement && element.matches(selector));\n                }) ?? null;\n        }\n        if (!this.isOpen) {\n            this.timeStarted = Date.now();\n            this.toggle(true);\n        }\n    }\n    handleMouseup(e) {\n        if (this.shouldClosePopover(e) ||\n            (timePassed(this.timeStarted) && !this.emitterIsInsidePopover(e))) {\n            this.toggle(false);\n        }\n        this.focusShouldBeFocusedMaybe();\n    }\n    handleKeydown(e) {\n        if (this.keyIsPressed) {\n            return;\n        }\n        this.keyIsPressed = true;\n        switch (e.key) {\n            case 'Enter':\n            case ' ':\n                if (this.emitterIsInsidePopover(e) && !this.shouldClosePopover(e)) {\n                    return;\n                }\n                this.toggle();\n                break;\n            case 'Escape':\n                if (this.isOpen) {\n                    this.toggle(false);\n                }\n                break;\n            default:\n                // avoid toggle the element when the user cmd-tabs away from the browser\n                // or dispatching Tab key\n                if (!((e.key === 'Meta' && e.metaKey) || e.key === 'Tab')) {\n                    this.toggle(true);\n                }\n        }\n    }\n    handleKeyup() {\n        this.keyIsPressed = false;\n    }\n    /**\n     * Handle close event that emitted by content inside element.\n     * Doesn't dispatch another one when close\n     */\n    handleContentCloseEvent(e) {\n        const dispatchedByContent = e.target !== this.element;\n        if (dispatchedByContent && this.isOpen) {\n            this.host.toggleAttribute('open', false);\n            this.element?.toggleAttribute('show', false);\n        }\n    }\n    /**\n     * Toggles the visibility of the element.\n     */\n    toggle(force) {\n        if (force ?? !this.isOpen) {\n            this.show();\n        }\n        else {\n            this.host.toggleAttribute('open', false);\n            this.element?.toggleAttribute('show', false);\n            this.element?.dispatchEvent(new CustomEvent(CLOSE_EVENT, { composed: true, bubbles: true }));\n        }\n    }\n    show() {\n        if (this.isOpen) {\n            return;\n        }\n        this.setBoundingBox();\n        this.host.toggleAttribute('open', true);\n        this.element?.toggleAttribute('show', true);\n        // we need to ensure that the selected element is in the view\n        if (this.selected > -1 && this.selected === this.highlighted) {\n            setTimeout(() => {\n                this.items[this.selected].scrollIntoView({ block: 'nearest' });\n            }, 100);\n        }\n    }\n    emitterIsInsidePopover(e) {\n        return e.composedPath().includes(this.element);\n    }\n    setBoundingBox() {\n        this.dimensionController.setBoundingBox(this.options.boundingElement ?? getControl(this.host));\n    }\n    shouldClosePopover(e) {\n        return e\n            .composedPath()\n            .some((element, i, path) => i <= path.indexOf(this.element) &&\n            element instanceof Element &&\n            element.hasAttribute(CLOSE_POPOVER_ATTR));\n    }\n    focusShouldBeFocusedMaybe() {\n        if (this.shouldBeFocused) {\n            this.shouldBeFocused.focus();\n            this.shouldBeFocused = null;\n        }\n    }\n    /**\n     * Indicates that the popover element is visible.\n     */\n    get isOpen() {\n        return !!this.element?.hasAttribute('show');\n    }\n    get selected() {\n        return this.items.findIndex((item) => item.hasAttribute('selected'));\n    }\n    get highlighted() {\n        return this.items.findIndex((item) => item.hasAttribute('highlight'));\n    }\n    get element() {\n        return this.host.renderRoot.querySelector(this.options.elementSelector);\n    }\n    get items() {\n        return Array.from(this.host.querySelectorAll(this.options.itemSelector));\n    }\n}\n//# sourceMappingURL=toggle.controller.js.map","import { HighlightController, SelectedController, ToggleController, } from './controllers';\nimport { POPOVER_EVENT, } from './popover.model';\nimport { TAG_NAME } from './tag';\n/**\n * Controls the popover behaviour by mouse and keyboard:\n * - toggle the popover (delegated to `ToggleController`)\n * - highlight the popover by keyboard (delegated to `HighlightController`)\n * - select the highlighted iem by keyboard (delegated to `SelectedController`)\n *\n * The PopoverController is not added to the popover component (as you might assume),\n * but can be used by a component that hosts a popover. The reason for this is that\n * the host element is key to the functionality, as this element is responsible for\n * toggling the popover.\n */\nexport class PopoverController {\n    constructor(host, options) {\n        this.host = host;\n        this.options = options;\n        this.popoverSelector = TAG_NAME;\n        this.optionsSelector = 'oryx-option:not([hide])';\n        this.host.addController(this);\n        this.toggleController = new ToggleController(host, {\n            elementSelector: this.popoverSelector,\n            itemSelector: this.optionsSelector,\n            showOnFocus: true,\n            ...options,\n        });\n        this.highlightController = new HighlightController(host, this.optionsSelector);\n        this.selectedController = new SelectedController(host, this.optionsSelector);\n        this.handleKeydown = this.handleKeydown.bind(this);\n        this.handleInput = this.handleInput.bind(this);\n        this.handleSelectEvent = this.handleSelectEvent.bind(this);\n    }\n    hostConnected() {\n        this.host.addEventListener('keydown', this.handleKeydown);\n        this.host.addEventListener('input', this.handleInput);\n        this.host.addEventListener(POPOVER_EVENT, this.handleSelectEvent);\n    }\n    hostDisconnected() {\n        this.host.removeEventListener('keydown', this.handleKeydown);\n        this.host.removeEventListener('input', this.handleInput);\n        this.host.removeEventListener(POPOVER_EVENT, this.handleSelectEvent);\n    }\n    selectByValue(value, omitDispatchEvent) {\n        const index = this.items.findIndex((item) => item.value === value);\n        this.selectedController.select(index, omitDispatchEvent);\n        if (this.toggleController.isOpen) {\n            this.items[index]?.scrollIntoView({ block: 'nearest' });\n        }\n    }\n    handleKeydown(e) {\n        switch (e.key) {\n            case 'Enter':\n                if (this.toggleController.isOpen) {\n                    this.selectedController.select(this.highlightController.highlight);\n                }\n                break;\n            case ' ':\n                if (e.target instanceof HTMLElement && this.isReadonly(e.target)) {\n                    if (this.toggleController.isOpen) {\n                        this.selectedController.select(this.highlightController.highlight);\n                    }\n                    e.preventDefault();\n                }\n                break;\n        }\n    }\n    handleInput(e) {\n        if (!e.inputType) {\n            return;\n        }\n        const composedTarget = e.composedPath()[0];\n        if (e.target?.value ||\n            (composedTarget instanceof HTMLInputElement && composedTarget?.value)) {\n            this.toggleController.toggle(true);\n        }\n        else {\n            this.selectedController.deselect();\n        }\n    }\n    handleSelectEvent(e) {\n        if (e.detail.selected) {\n            const itemIndex = this.items.findIndex((item) => item === e.detail.selected);\n            this.selectedController.select(itemIndex);\n        }\n        else {\n            this.selectedController.deselect();\n        }\n    }\n    isReadonly(target) {\n        return (target instanceof HTMLSelectElement ||\n            (target instanceof HTMLInputElement && target.readOnly));\n    }\n    get items() {\n        return Array.from(this.host.querySelectorAll(this.optionsSelector));\n    }\n}\n//# sourceMappingURL=popover.controller.js.map"],"names":["isSafari","nonFocusableOnClickInSafari","DimensionController","host","element","vOffset","_a","maxHeight","_b","POPOVER_HEIGHT","maxWidth","_c","top","right","bottom","left","boundingElementWidth","boundingElementHeight","isRTL","toRight","toLeft","properties","propName","width","height","property","OUT_OF_INDEX","HighlightController","listItemsSelector","CLOSE_EVENT","item","index","option","e","moveBy","fallback","highlight","SelectedController","omitDispatchEvent","selected","event","timePassed","start","timeGap","ToggleController","options","isFocusable","selector","force","getControl","i","path","CLOSE_POPOVER_ATTR","PopoverController","TAG_NAME","POPOVER_EVENT","value","composedTarget","itemIndex","target"],"mappings":"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"}